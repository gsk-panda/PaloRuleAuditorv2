1. Device groups list
Check that we see all device groups.
GET https://10.1.0.100/api/?type=config&action=get&xpath=/config/devices/entry[@name='localhost.localdomain']/device-group&key=YOUR_API_KEY
Return: full response (or at least the <result> section with the device-group entries).
2. Pre-rulebase security rules for one device group
Check rule list and structure for one group (e.g. one that should have many rules).
Replace DEVICE_GROUP_NAME with a real group (e.g. ISS).
GET https://10.1.0.100/api/?type=config&action=get&xpath=/config/devices/entry[@name='localhost.localdomain']/device-group/entry[@name='DEVICE_GROUP_NAME']/pre-rulebase/security/rules&key=YOUR_API_KEY
Return: full response. If it’s huge, the first ~50 lines plus one or two full <entry name="SomeRuleName">...</entry> blocks are enough.
3. Rule-hit-count for 2–3 rules in that device group
Check hit-count response shape (pre-rulebase vs rule-base, device-vsys, empty tags).
Use one rule you know has no hits (or only on some devices) and one with hits. Build the cmd like this (same as the app):
Single rule:
cmd=<show><rule-hit-count><device-group><entry name="DEVICE_GROUP_NAME"><pre-rulebase><entry name="security"><rules><rule-name><entry name="RULE_NAME_1"/></rule-name></rules></entry></pre-rulebase></entry></device-group></rule-hit-count></show>
Two rules: add a second <entry name="RULE_NAME_2"/> inside <rule-name>...</rule-name>.
URL (single rule; URL-encode the cmd if needed):
GET https://10.1.0.100/api/?type=op&cmd=<show><rule-hit-count><device-group><entry name="DEVICE_GROUP_NAME"><pre-rulebase><entry name="security"><rules><rule-name><entry name="RULE_NAME_1"/></rule-name></rules></entry></pre-rulebase></entry></device-group></rule-hit-count></show>&key=YOUR_API_KEY
Return: full response for that request (so we can see whether the result is under pre-rulebase or rule-base and how device-vsys / hit counts look).
4. Shared pre-rulebase rules (optional)
Check if we’re over-filtering by treating too many rules as Shared.
GET https://10.1.0.100/api/?type=config&action=get&xpath=/config/shared/pre-rulebase/security/rules&key=YOUR_API_KEY
Return: either the full response or the first 100 lines and how many <entry name="..."> rules there are (or a count).
Summary
#	Purpose
1	Device groups – are we seeing all DGs?
2	Rules for one DG – are we reading rule names and structure correctly?
3	Rule-hit-count for 1–2 rules – are we parsing hit data and device-vsys correctly?
4	Shared rules – are we excluding too many rules?
Use the same Panorama base URL and API key you use in the app. For #2 and #3, use one device group that you expect to have many rules and at least one rule you know should be “unused” on some devices. Once you paste those results (in order), we can pinpoint why only 1 of 1000+ rules is being flagged.
